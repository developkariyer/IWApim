<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataTable Example</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <link href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css" rel="stylesheet">
	<link href="https://cdn.datatables.net/buttons/2.3.7/css/buttons.dataTables.min.css" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta2/css/bootstrap-select.min.css">

    <!-- jQuery (Make sure this is loaded first) -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    
    <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.3.7/js/dataTables.buttons.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.3.7/js/buttons.colVis.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta2/js/bootstrap-select.min.js"></script>
</head>
<body>

<table id="example" class="display table table-striped table-bordered" style="width:100%">
    <thead>
        <tr>
            <th>
                <select id="iwaskuFilter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="IWASKU"></select>
            </th>
            <th>
                <select id="productCategoryFilter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Kategori"></select>
            </th>
            <th>
                <select id="productIdentifierFilter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Kod"></select>
            </th>
            <th>
                <select id="nameFilter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Ürün Adı"></select>
            </th>
            <th>
                <select id="variationSizeFilter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Ebat"></select>
            </th>
            <th>
                <select id="variationColorFilter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Renk"></select>
            </th>
            <th>
                <select id="packageDimension1Filter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="En"></select>
            </th>
            <th>
                <select id="packageDimension2Filter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Boy"></select>
            </th>
            <th>
                <select id="packageDimension3Filter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Yükseklik"></select>
            </th>
            <th>
0                <select id="packageWeightFilter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Ağırlık"></select>
            </th>
            <th>Örnek Resim</th> <!-- No select for image -->
            <th>
                <select id="productCostFilter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Ürün Maliyeti"></select>
            </th>
            <th>
                <select id="pricingModel1Filter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Dağıtım Modeli 1"></select>
            </th>
            <th>
                <select id="pricingModel2Filter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Dağıtım Modeli 2"></select>
            </th>
            <th>
                <select id="pricingModel3Filter" class="selectpicker form-select-sm" multiple data-selected-text-format="count > 3" title="Dağıtım Modeli 3"></select>
            </th>
        </tr>
    </thead>
    <tbody>
        {% for product in products %}
            <tr>
                <td>{{ product.iwasku }}</td>
                <td>{{ product.productCategory }}</td>
                <td>{{ product.productIdentifier }}</td>
                <td>{{ product.name }}</td>
                <td>{{ product.variationSize }}</td>
                <td>{{ product.variationColor }}</td>
                <td>{{ product.packageDimension1 }}</td>
                <td>{{ product.packageDimension2 }}</td>
                <td>{{ product.packageDimension3 }}</td>
                <td>{{ product.packageWeight }}</td>
                <td><img src="{{ product.imageUrl }}" alt="Product Image" style="max-width: 100px; max-height: 100px;"></td>
                <td>{{ product.productCost }}</td>
                <td>{{ product.productDimension1 }}</td>
                <td>{{ product.productDimension2 }}</td>
                <td>{{ product.productDimension3 }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<script>
    $(document).ready(function() {
        var table = $('#example').DataTable({
            dom: 'Bfrtip',  // Add Buttons to DOM
            buttons: [
                'colvis'  // Column Visibility Button
            ]
        });
    
        // Define columns and IDs as key-value pairs
        var columns = {
            0: 'iwasku', 
            1: 'productCategory', 
            2: 'productIdentifier', 
            3: 'name', 
            4: 'variationSize', 
            5: 'variationColor', 
            6: 'packageDimension1', 
            7: 'packageDimension2', 
            8: 'packageDimension3', 
            9: 'packageWeight', 
            11: 'productCost', 
            12: 'pricingModel1', 
            13: 'pricingModel2', 
            14: 'pricingModel3'
        };
    
        // Populate the selectpicker dropdowns for each column
        {% for columnIndex, columnId in {
            0: 'iwasku', 
            1: 'productCategory', 
            2: 'productIdentifier', 
            3: 'name', 
            4: 'variationSize', 
            5: 'variationColor', 
            6: 'packageDimension1', 
            7: 'packageDimension2', 
            8: 'packageDimension3', 
            9: 'packageWeight', 
            11: 'productCost', 
            12: 'pricingModel1', 
            13: 'pricingModel2', 
            14: 'pricingModel3'
        } %}
            table.column({{ columnIndex }}).data().unique().sort().each(function(d, j) {
                $('#{{ columnId }}Filter').append('<option value="' + d + '">' + d + '</option>');
            });
        {% endfor %}
    
        // Refresh selectpicker after appending options
        $('.selectpicker').selectpicker('refresh');
    
        // Handle filtering for all select elements
        {% for columnIndex, columnId in {
            0: 'iwasku', 
            1: 'productCategory', 
            2: 'productIdentifier', 
            3: 'name', 
            4: 'variationSize', 
            5: 'variationColor', 
            6: 'packageDimension1', 
            7: 'packageDimension2', 
            8: 'packageDimension3', 
            9: 'packageWeight', 
            11: 'productCost', 
            12: 'pricingModel1', 
            13: 'pricingModel2', 
            14: 'pricingModel3'
        } %}
            $('#{{ columnId }}Filter').on('change', function() {
                var selectedValues = $(this).val();
                var searchTerm = selectedValues ? selectedValues.join('|') : '';
                table.column({{ columnIndex }}).search(searchTerm, true, false).draw();
            });
        {% endfor %}
    });
</script>
    


</body>
</html>